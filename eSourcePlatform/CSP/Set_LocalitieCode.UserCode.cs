///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// Your custom recording code should go in this file.
// The designer will only add methods to this file, so your custom code won't be overwritten.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Net;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;
using System.Web.Script.Serialization;
using WinForms = System.Windows.Forms;
using Ranorex;
using Ranorex.Core;
using Ranorex.Core.Repository;
using Ranorex.Core.Testing;

namespace CSP
{
	//To send in the body 
	public class LocalityCode
	{
		
		
		public string id {get;set;}
		public string studyId {get;set;}
		public List<localitie> localities {get;set;}
		//public string localities.id {get;set;}
		//public string localities.name {get;set;}
		//public string localities.code {get;set;}
			
		public	LocalityCode(string id,string studyId, List<localitie> localities)
		{
			
			this.id=id;
	        this.studyId=studyId;
	        this.localities=localities;
	        
	       
		}
	}
	
	//Object to cpture the results 
	public class LocalityCodeR
	{
		
		
	public string id {get;set;}
    public string studyId  {get;set;}
    public localitie[] localities {get;set;}
		
	public	LocalityCodeR()
	{
	
	}
	}
	 public class localitie
    {
       
      
        public string id {get;set;}
	    public string name {get;set;}
	    public string code {get;set;}

        

        public localitie()
        {

        }
    }
    public partial class Set_LocalitieCode
    {
       //variables:
      
            
	      
       	
        private void Init()
        {
       	 	
        }

        public void SetLocalitie_Code(string id, string studyId, string DOM, string Autoken)
        {
        	localitie l = new localitie();
			l.id = "7"; 
			l.name= "USA - English"; 
			l.code= "en_US";
			
	      
			List<localitie> localities = new List<CSP.localitie>();
	       	
			localities.Add(l);
			
             // setting up a localitycode
        	string url = "https://" + DOM +"/api/studies/163742/settings";
        	HttpWebRequest httpRequest =(HttpWebRequest)WebRequest.Create(url);
        	httpRequest.ContentType = "application/json";
        	httpRequest.Method="PUT";
        	httpRequest.Headers.Add("Authorization", Autoken);
        	
        	
        	//Create JSON object containing for the body locality code details
        	LocalityCode assessmentObject = new LocalityCode(id,studyId,localities);
        	using (StreamWriter sw = new StreamWriter(httpRequest.GetRequestStream()))
        	{
        		string json = new JavaScriptSerializer().Serialize(assessmentObject);
        		
        		//Debugging Request
        		Report.Info("Data to send: " + json);
        		
        		sw.Write(json);
        		sw.Flush();
        		sw.Close();
        	}
        	
        	
        	
        	//send the API Call 
        	HttpWebResponse httpResponse = (HttpWebResponse)httpRequest.GetResponse();
        	//CreateObject:
           LocalityCodeR responseObject = new LocalityCodeR();
        	
        	using (StreamReader sr = new StreamReader(httpResponse.GetResponseStream()))
        	
        	{
        		
        		string response= sr.ReadToEnd();
        		responseObject = new JavaScriptSerializer().Deserialize<LocalityCodeR>(response);
        		
        		//string Z = responseObject.studyId;
        		
        		Report.Log(ReportLevel.Info, "StudyID:"+ response);
        		
        		
        			{
        		}
        	}
        }

    }
}
