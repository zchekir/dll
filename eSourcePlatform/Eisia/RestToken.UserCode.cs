///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// Your custom recording code should go in this file.
// The designer will only add methods to this file, so your custom code won't be overwritten.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;
using WinForms = System.Windows.Forms;

using Ranorex;
using Ranorex.Core;
using Ranorex.Core.Repository;
using Ranorex.Core.Testing;

namespace Eisia
{
    public partial class RestToken
    {
       public static DataTable dt = new DataTable();
        private void Init()
        {
            
        }

        public void _RestToken(string DBserver, string Database, string Authentication, string dbUsername, string dbPassword, string NewKey)
        {
            
        	dt.Reset();
			//Key="238dfa4e-3b8a-40d5-9b0a-a8a8dd93ee43"; 
			// QueryDB
			string query = @"SELECT
		      resetpasswordtoken,username
              from [UserData].[User]
              where username = @NewKey";
			
			//Connecting to SQL DB:
			string sqlConnString = string.Format("Server={0};Database={1};User Id={2};Password={3};Authentication={4};Connection Timeout={5};",DBserver, Database, dbUsername,dbPassword, Authentication, "30");
			//CreateObject:
			SqlDataAdapter da = new SqlDataAdapter(query, sqlConnString);
			da.SelectCommand.Parameters.AddWithValue("@NewKey", NewKey);
			// Get the data from DB
			using (da)
			{
				da.Fill(dt);
			}
			ResetToken = dt.Rows[0][0].ToString();
			TokenKey = dt.Rows[0][1].ToString();
			Report.Log(ReportLevel.Info, "Reset Token: " + ResetToken + "Username: " +  TokenKey );
        	
        	
        	
        }

    }
}
